<div class="card">
  <div class="card-header  text-center">
    {{panelName}}
    <div class="float-right" *ngIf="myRank<rankings.length*0.7">
      <button
        [ngClass]="{'btn-primary':expand ,'btn-secondary':!expand}" class="btn  btn-sm"
        (click)="toggleExpand($event)">
        <span *ngIf="!expand" class="oi oi-chevron-right"></span>
        <span *ngIf="expand" class="oi oi-chevron-bottom"></span>
      </button>
    </div>
  </div>
  <div class="card-body" *ngIf="myRank<rankings.length*0.7">
    <div>
      <ng-template #leaderPop>
        Leader
      </ng-template>
      <ng-template #followerPop>
        Follower
      </ng-template>
      <ng-template #mixedPop>
        Follower and Leader
      </ng-template>

      <div class="row" *ngIf="renderSections.openTop" (click)="toggleExpand()">
        <div class="col-12 text-center">
          <span class="oi oi-ellipses"></span>
        </div>
      </div>
      <ng-container *ngFor="let rank of rankings; let i = index">
        <ng-template #rankPop>
          <ng-container *ngIf="isBetter(rank.score)">
            Watch out, a good dancer!
          </ng-container>
          <ng-container *ngIf="isTheSame(rank.score)">
            A dancer with similar skills to yours.
          </ng-container>
          <ng-container *ngIf="isWorst(rank.score)">
            No worries.
          </ng-container>
        </ng-template>
        <div *ngIf="(i>=renderSections.first.start && i<renderSections.first.end) ">
          <a [ngClass]="{'me':i == myRank}"
             [href]="url(rank.dancer)"
             class="dancer row"
             style="white-space: nowrap">
            <div class="col-1 offset-sm-2">
              <span [tooltip]="rankPop" container="body" class="oi oi-chevron-top" [style.color]="color(rank.score)"
                    *ngIf="isBetter(rank.score)"></span>
              <span class="oi oi-minus" [tooltip]="rankPop" container="body" [style.color]="color(rank.score)"
                    *ngIf="isTheSame(rank.score)"></span>
              <span class="oi oi-chevron-bottom" [style.color]="color(rank.score)"
                    [tooltip]="rankPop" container="body"
                    *ngIf="isWorst(rank.score)"></span>
            </div>
            <div class="col">
              <img [tooltip]="leaderPop" container="body" class="role" src="assets/leader.svg"
                   *ngIf="rank.role == RoleType.Lead"/>
              <img [tooltip]="followerPop" container="body" class="role" src="assets/follower.svg"
                   *ngIf="rank.role == RoleType.Follow"/>
              <img [tooltip]="mixedPop" container="body" class="role" src="assets/couple.svg"
                   *ngIf="rank.role == RoleType.Mixed"/>

              {{rank.dancer.firstName}} {{rank.dancer.lastName}} {{rank.score | number}} {{rank.accuracy | number}}
            </div>
            <div class="col3 text-right">
              <span class="placement-section" *ngIf="i == myRank">{{placementDescription()}}</span>
            </div>
          </a>
        </div>

        <div class="row"
             *ngIf="i==rankings.length-1 && !(i==renderSections.first.end)">
          <div class="col-12 text-center">
            <span class="oi oi-ellipses" (click)="toggleExpand($event)"></span>
          </div>
        </div>
      </ng-container>
    </div>
  </div>

  <div class="card-footer" *ngIf="gotBetterCount > 0 && myRank<rankings.length*0.7">
    You outperformed <span class="badge badge-success"><strong>{{gotBetterCount}}</strong></span> of your competitors,
    who usually perform better than you on your last competition.
  </div>

  <div class="card-body text-center" *ngIf="myRank>=rankings.length*0.7">
    Not enough data to show :(
  </div>
</div>
